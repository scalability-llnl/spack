from spack import *

class Hypre(Package):
    """Hypre is a library of high performance preconditioners that features parallel multigrid 
    methods for both structured and unstructured grid problems."""

    homepage = "https://computation.llnl.gov/project/linear_solvers/software.php"
    url      = "https://computation.llnl.gov/project/linear_solvers/download/hypre-2.10.0b.tar.gz"

    version('2.10.0b', '768be38793a35bb5d055905b271f5b8e')

    depends_on("openmpi")
    depends_on("blas")
    depends_on("lapack")

    def install(self, spec, prefix):
        lapack_dir = spec['lapack'].prefix        
        configure(
            "--prefix=%s" % prefix, 
            "--with-blas-libs=blas", 
            "--with-blas-lib-dirs=%s/lib" % spec['blas'].prefix, 
            "--with-lapack-libs=lapack blas", 
            "--with-lapack-lib-dirs=%s/lib" % lapack_dir)
        
        make()
        make("install")
